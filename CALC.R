lmMod<-lm(RCW~RPCYD+IOTD+PRIME+RIFM+TI+TD+TR1+TR2+I(ISE1*TAX)+I(ISE1*ISEF1)+I(ISE1*ISEM1), data = MAIN_ISE)
summary(lmMod)
selectedMod<-step(lmMod)
print(summary(selectedMod, diagnostics=TRUE), digits = 2)
summ(selectedMod, model.info = FALSE, digits=6)


MAIN_ISE$RCWA <- 0.040558-0.046875*MAIN_ISE$RPCYD+0.184550*MAIN_ISE$IOTD-0.205878*MAIN_ISE$PRIME+0.019279*MAIN_ISE$RIFM+0.134269*MAIN_ISE$TI-0.129523*MAIN_ISE$TD+0.262576*MAIN_ISE$TR1-0.309748*MAIN_ISE$TR2+0.996577*(MAIN_ISE$ISE1*MAIN_ISE$TAX)-0.415382*(MAIN_ISE$ISE1*MAIN_ISE$ISEM1)
MAIN_ISE$RCWO <- 0.040558-0.046875*MAIN_ISE$RPCYD+0.184550*MAIN_ISE$IOTD-0.205878*MAIN_ISE$PRIME
MAIN_ISE$DELTA<- MAIN_ISE$RCWA-MAIN_ISE$RCWO
MAIN_ISE$NOE<-(MAIN_ISE$DELTA*MAIN_ISE$VOP*1000) / MAIN_ISE$GDP 

MAIN_ISE$RCWT<- 0.040558-0.046875*MAIN_ISE$RPCYD+0.184550*MAIN_ISE$IOTD-0.205878*MAIN_ISE$PRIME+0.019279*MAIN_ISE$RIFM
MAIN_ISE$DELTAT<- MAIN_ISE$RCWA-MAIN_ISE$RCWT
MAIN_ISE$NOET<-(MAIN_ISE$DELTAT*MAIN_ISE$VOP*1000) / MAIN_ISE$GDP

MAIN_ISE$RCWC<- 0.040558-0.046875*MAIN_ISE$RPCYD+0.184550*MAIN_ISE$IOTD-0.205878*MAIN_ISE$PRIME+0.134269*MAIN_ISE$TI-0.129523*MAIN_ISE$TD+0.262576*MAIN_ISE$TR1-0.309748*MAIN_ISE$TR2+0.996577*(MAIN_ISE$ISE1*MAIN_ISE$TAX)-0.415382*(MAIN_ISE$ISE1*MAIN_ISE$ISEM1)
MAIN_ISE$DELTAC<- MAIN_ISE$RCWA-MAIN_ISE$RCWC
MAIN_ISE$NOEC<-(MAIN_ISE$DELTAC*MAIN_ISE$VOP*1000) / MAIN_ISE$GDP

MAIN_ISE$RCWI<- 0.040558-0.046875*MAIN_ISE$RPCYD+0.184550*MAIN_ISE$IOTD-0.205878*MAIN_ISE$PRIME+0.019279*MAIN_ISE$RIFM+0.134269*MAIN_ISE$TI-0.129523*MAIN_ISE$TD+0.262576*MAIN_ISE$TR1-0.309748*MAIN_ISE$TR2
MAIN_ISE$DELTAI<- MAIN_ISE$RCWA-MAIN_ISE$RCWI
MAIN_ISE$NOEI<-(MAIN_ISE$DELTAI*MAIN_ISE$VOP*1000) / MAIN_ISE$GDP


names(MAIN_ISE$NOE)<-c("1996","1997","1998","1999","2000","2001","2002","2003","2004","2005","2006", "2007", "2008", "2009", "2010", "2011", "2012", "2013", "2014", "2015", "2016", "2017", "2018","2019")
barplot(MAIN_ISE$NOE, las=2, cex.names=.8, main="NOE ISRAEL", xlab = "YEAR", ylab="NOE", ylim = c(0,0.3), border="red", col="blue", density=10)
names(MAIN_ISE$NOET)<-c("1996","1997","1998","1999","2000","2001","2002","2003","2004","2005","2006", "2007", "2008", "2009", "2010", "2011", "2012", "2013", "2014", "2015", "2016", "2017", "2018","2019")
barplot(MAIN_ISE$NOET, las=2, cex.names=.8, main="NOET ISRAEL", xlab = "YEAR", ylab="NOET", ylim = c(0,0.25), border="red", col="blue", density=10)
names(MAIN_ISE$NOEC)<-c("1996","1997","1998","1999","2000","2001","2002","2003","2004","2005","2006", "2007", "2008", "2009", "2010", "2011", "2012", "2013", "2014", "2015", "2016", "2017", "2018","2019")
barplot(MAIN_ISE$NOEC, las=2, cex.names=.8, main="NOEC ISRAEL", xlab = "YEAR", ylab="NOEC", ylim = c(0,0.06), border="red", col="blue", density=10)

#Durbin-Watson test for Autocorrelated Errors 
dwtest(selectedMod)
#Breusch-Godfrey Serial Correlation LM Test for higher auto..
#bgtest(selectedMod, order = 2)
checkresiduals(selectedMod, test = "BG")
#test for normality
hist(residuals(selectedMod),main = "Histogram of residuals, The Model", xlab = "residuals", border = "light blue", col = "blue")
boxplot(residuals(selectedMod))
shapiro.test(residuals(selectedMod))
#test for Heteroscedasticity
bptest(selectedMod)
#packege: openxlsx
write.xlsx(MAIN_ISE, file = "MAIN_ISE_R.xlsx", sheetName="ISE", append=FALSE)


library(psych)
#DESCRIPTIVE STATISTICS
descriptives<- describe(MAIN_ISE_describe)
write.xlsx(descriptives, file = "describe.xlsx", sheetName="descriptives", append=FALSE)

##############################################################WITH 1995
lmMod<-lm(RCW~RPCYD+IOTD+PRIME+RIFM+TI+TD+TR1+TR2+I(ISE1*TAX)+I(ISE1*ISEF1)+I(ISE1*ISEM1), data = MAIN_ISE_1995_CORRECTED)
summary(lmMod)
selectedMod<-step(lmMod)
print(summary(selectedMod, diagnostics=TRUE), digits = 2)
summ(selectedMod, model.info = FALSE, digits=6)


MAIN_ISE_1995_CORRECTED$RCWA <- 0.041165-0.044826*MAIN_ISE_1995_CORRECTED$RPCYD+0.179287*MAIN_ISE_1995_CORRECTED$IOTD-0.196685*MAIN_ISE_1995_CORRECTED$PRIME+0.015965*MAIN_ISE_1995_CORRECTED$RIFM+0.082274*MAIN_ISE_1995_CORRECTED$TI-0.169971*MAIN_ISE_1995_CORRECTED$TD+0.254047*MAIN_ISE_1995_CORRECTED$TR1-0.247737*MAIN_ISE_1995_CORRECTED$TR2+1.270645*(MAIN_ISE_1995_CORRECTED$ISE1*MAIN_ISE_1995_CORRECTED$TAX)-0.681331*(MAIN_ISE_1995_CORRECTED$ISE1*MAIN_ISE_1995_CORRECTED$ISEM1)
MAIN_ISE_1995_CORRECTED$RCWO <- 0.041165-0.044826*MAIN_ISE_1995_CORRECTED$RPCYD+0.179287*MAIN_ISE_1995_CORRECTED$IOTD-0.196685*MAIN_ISE_1995_CORRECTED$PRIME
MAIN_ISE_1995_CORRECTED$DELTA<- MAIN_ISE_1995_CORRECTED$RCWA-MAIN_ISE_1995_CORRECTED$RCWO
MAIN_ISE_1995_CORRECTED$NOE<-(MAIN_ISE_1995_CORRECTED$DELTA*MAIN_ISE_1995_CORRECTED$VOP*1000) / MAIN_ISE_1995_CORRECTED$GDP 

MAIN_ISE_1995_CORRECTED$RCWT<- 0.041165-0.044826*MAIN_ISE_1995_CORRECTED$RPCYD+0.179287*MAIN_ISE_1995_CORRECTED$IOTD-0.196685*MAIN_ISE_1995_CORRECTED$PRIME+0.015965*MAIN_ISE_1995_CORRECTED$RIFM
MAIN_ISE_1995_CORRECTED$DELTAT<- MAIN_ISE_1995_CORRECTED$RCWA-MAIN_ISE_1995_CORRECTED$RCWT
MAIN_ISE_1995_CORRECTED$NOET<-(MAIN_ISE_1995_CORRECTED$DELTAT*MAIN_ISE_1995_CORRECTED$VOP*1000) / MAIN_ISE_1995_CORRECTED$GDP

MAIN_ISE_1995_CORRECTED$RCWC<- 0.041165-0.044826*MAIN_ISE_1995_CORRECTED$RPCYD+0.179287*MAIN_ISE_1995_CORRECTED$IOTD-0.196685*MAIN_ISE_1995_CORRECTED$PRIME+0.082274*MAIN_ISE_1995_CORRECTED$TI-0.169971*MAIN_ISE_1995_CORRECTED$TD+0.254047*MAIN_ISE_1995_CORRECTED$TR1-0.247737*MAIN_ISE_1995_CORRECTED$TR2+1.270645*(MAIN_ISE_1995_CORRECTED$ISE1*MAIN_ISE_1995_CORRECTED$TAX)-0.681331*(MAIN_ISE_1995_CORRECTED$ISE1*MAIN_ISE_1995_CORRECTED$ISEM1)
MAIN_ISE_1995_CORRECTED$DELTAC<- MAIN_ISE_1995_CORRECTED$RCWA-MAIN_ISE_1995_CORRECTED$RCWC
MAIN_ISE_1995_CORRECTED$NOEC<-(MAIN_ISE_1995_CORRECTED$DELTAC*MAIN_ISE_1995_CORRECTED$VOP*1000) / MAIN_ISE_1995_CORRECTED$GDP

MAIN_ISE_1995_CORRECTED$RCWI<- 0.041165-0.044826*MAIN_ISE_1995_CORRECTED$RPCYD+0.179287*MAIN_ISE_1995_CORRECTED$IOTD-0.196685*MAIN_ISE_1995_CORRECTED$PRIME+0.015965*MAIN_ISE_1995_CORRECTED$RIFM+0.082274*MAIN_ISE_1995_CORRECTED$TI-0.169971*MAIN_ISE_1995_CORRECTED$TD+0.254047*MAIN_ISE_1995_CORRECTED$TR1-0.247737*MAIN_ISE_1995_CORRECTED$TR2
MAIN_ISE_1995_CORRECTED$DELTAI<- MAIN_ISE_1995_CORRECTED$RCWA-MAIN_ISE_1995_CORRECTED$RCWI
MAIN_ISE_1995_CORRECTED$NOEI<-(MAIN_ISE_1995_CORRECTED$DELTAI*MAIN_ISE_1995_CORRECTED$VOP*1000) / MAIN_ISE_1995_CORRECTED$GDP


names(MAIN_ISE$NOE)<-c("1996","1997","1998","1999","2000","2001","2002","2003","2004","2005","2006", "2007", "2008", "2009", "2010", "2011", "2012", "2013", "2014", "2015", "2016", "2017", "2018","2019")
barplot(MAIN_ISE$NOE, las=2, cex.names=.8, main="NOE ISRAEL", xlab = "YEAR", ylab="NOE", ylim = c(0,0.3), border="red", col="blue", density=10)
names(MAIN_ISE$NOET)<-c("1996","1997","1998","1999","2000","2001","2002","2003","2004","2005","2006", "2007", "2008", "2009", "2010", "2011", "2012", "2013", "2014", "2015", "2016", "2017", "2018","2019")
barplot(MAIN_ISE$NOET, las=2, cex.names=.8, main="NOET ISRAEL", xlab = "YEAR", ylab="NOET", ylim = c(0,0.25), border="red", col="blue", density=10)
names(MAIN_ISE$NOEC)<-c("1996","1997","1998","1999","2000","2001","2002","2003","2004","2005","2006", "2007", "2008", "2009", "2010", "2011", "2012", "2013", "2014", "2015", "2016", "2017", "2018","2019")
barplot(MAIN_ISE$NOEC, las=2, cex.names=.8, main="NOEC ISRAEL", xlab = "YEAR", ylab="NOEC", ylim = c(0,0.06), border="red", col="blue", density=10)

#Durbin-Watson test for Autocorrelated Errors 
dwtest(selectedMod)
#Breusch-Godfrey Serial Correlation LM Test for higher auto..
#bgtest(selectedMod, order = 2)
checkresiduals(selectedMod, test = "BG")
#test for normality
hist(residuals(selectedMod),main = "Histogram of residuals, The Model", xlab = "residuals", border = "light blue", col = "blue")
boxplot(residuals(selectedMod))
shapiro.test(residuals(selectedMod))
#test for Heteroscedasticity
bptest(selectedMod)
#packege: openxlsx
write.xlsx(MAIN_ISE, file = "MAIN_ISE_R.xlsx", sheetName="ISE", append=FALSE)


library(psych)
#DESCRIPTIVE STATISTICS
descriptives<- describe(MAIN_ISE_describe)
write.xlsx(descriptives, file = "describe.xlsx", sheetName="descriptives", append=FALSE)
